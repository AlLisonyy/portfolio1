---
title: "Thesis data Main Analysis"
author: "Allison Li"
date: "03242025"
output: 
  html_document:
    encoding: UTF-8
    toc: true
    number_sections: false
    toc_float: true
    toc_depth: 4
    fig_caption: true
---
For this portfolio, I will continue to use the dataset from my thesis study. This portfolio will focus on the main analysis for my thesis study's data, which is mainly correlation analysis. In addition, I would like to create some visualization for presenting the correlations since I have around 30 variables. 

```{r load-data, include=FALSE}
##install packages
##install.packages("corrplot")
##install.packages("plotly")
##install.packages("ggcorrplot")
##install.packages("reshape2")

library(plotly)
library(ggcorrplot)
library(reshape2)
library(corrplot)
library(psych)
library(ggplot2)
library(ltm)
library(ppcor)
library(tidyverse)
library(haven)
library(dplyr)
Thesis_scale <- readRDS("Thesis_scale.rds")
```

## Step 1: partial correlations
### Bullshit Frequency scales and other variables's partial correlation when controled for lying tendency

```{r BFS and others}
##1. BFS and BPS
pcor.test(Thesis_scale$BFS_score, Thesis_scale$BPS_score, Thesis_scale$LIE_score)

##2. BFS and narcissism (short scale)
partial_BFSsdtnarc <- Thesis_scale %>% 
  select(BFS_score, sdtnarc_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BFSsdtnarc$BFS_score, partial_BFSsdtnarc$sdtnarc_score, partial_BFSsdtnarc$LIE_score)

##3, BFS and machiavellianism (short scale)
pcor.test(Thesis_scale$BFS_score, Thesis_scale$sdtmach_score, Thesis_scale$LIE_score)

##4. BFS and psychopathy (short scale)
pcor.test(Thesis_scale$BFS_score, Thesis_scale$sdtpsych_score, Thesis_scale$LIE_score)

##5. BFS and Narcissistic Personality Inventory
pcor.test(Thesis_scale$BFS_score, Thesis_scale$narc_score, Thesis_scale$LIE_score)

##6. BFS and Machiavellianism Personality scale
pcor.test(Thesis_scale$BFS_score, Thesis_scale$mach_score, Thesis_scale$LIE_score)

##7. BFS and Levenson Self-Report Psychopathy Scale
pcor.test(Thesis_scale$BFS_score, Thesis_scale$psycho_score, Thesis_scale$LIE_score)
##7.1
pcor.test(Thesis_scale$BFS_score, Thesis_scale$psychopri_score, Thesis_scale$LIE_score)
partial_BFSpsychosec <- Thesis_scale %>% 
  select(BFS_score, psychosec_score, LIE_score) %>% 
  drop_na()
##7.2
pcor.test(partial_BFSpsychosec$BFS_score, partial_BFSpsychosec$psychosec_score, partial_BFSpsychosec$LIE_score)

##8. BFS and self-esteem
pcor.test(Thesis_scale$BFS_score, Thesis_scale$se_score, Thesis_scale$LIE_score)

##BFS and HEXACO
##9. Honesty-Humility
partial_BFShon<- Thesis_scale %>% 
  select(BFS_score, hon_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BFShon$BFS_score, partial_BFShon$hon_score, partial_BFShon$LIE_score)
##10. Emotionality
partial_BFSemo <- Thesis_scale %>% 
  select(BFS_score, emo_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BFSemo$BFS_score, partial_BFSemo$emo_score, partial_BFSemo$LIE_score)
##11. Extraversion
partial_BFSextra <- Thesis_scale %>% 
  select(BFS_score, extra_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BFSextra$BFS_score, partial_BFSextra$extra_score, partial_BFSextra$LIE_score)
##12. Agreeableness
partial_BFSagree <- Thesis_scale %>% 
  select(BFS_score, agree_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BFSagree$BFS_score, partial_BFSagree$agree_score, partial_BFSagree$LIE_score)
##13. CONSCIENTIOUSNESS
partial_BFScons <- Thesis_scale %>% 
  select(BFS_score, cons_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BFScons$BFS_score, partial_BFScons$cons_score, partial_BFScons$LIE_score)
##14. Openness
partial_BFSopen <- Thesis_scale %>% 
  select(BFS_score, open_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BFSopen$BFS_score, partial_BFSopen$open_score, partial_BFSopen$LIE_score)

##15. BFS and Intellectual Humility Scale
partial_BFSih <- Thesis_scale %>% 
  select(BFS_score, ihs_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BFSih$BFS_score, partial_BFSih$ihs_score, partial_BFSih$LIE_score)

##16. BFS and Need for Closure
pcor.test(Thesis_scale$BFS_score, Thesis_scale$nclos_score, Thesis_scale$LIE_score)

##17. BFS and Need for Cognition
partial_BFSncog <- Thesis_scale %>% 
  select(BFS_score, ncog_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BFSncog$BFS_score, partial_BFSncog$ncog_score, partial_BFSncog$LIE_score)

##18. BFS and Actively Open Thinking Style
partial_BFSopenTS <- Thesis_scale %>% 
  select(BFS_score, openTS_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BFSopenTS$BFS_score, partial_BFSopenTS$openTS_score, partial_BFSopenTS$LIE_score)

##19. BFS and Close-minded Thinking Style
pcor.test(Thesis_scale$BFS_score, Thesis_scale$closeTS_score, Thesis_scale$LIE_score)

##20. BFS and prefer intuitive Thinking Style
partial_BFSintuitiveTS <- Thesis_scale %>% 
  select(BFS_score, intuitiveTS_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BFSintuitiveTS$BFS_score, partial_BFSintuitiveTS$intuitiveTS_score, partial_BFSintuitiveTS$LIE_score)

##21. BFS and prefer effortful Thinking Style
pcor.test(Thesis_scale$BFS_score, Thesis_scale$effortTS_score, Thesis_scale$LIE_score)

##22. BFS and Actively Open-Minded Thinking about Evidence Scale 
partial_BFSactiveopen <- Thesis_scale %>% 
  select(BFS_score, activeopen_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BFSactiveopen$BFS_score, partial_BFSactiveopen$activeopen_score, partial_BFSactiveopen$LIE_score)

##23. BFS and Faith in Intuition Scale
pcor.test(Thesis_scale$BFS_score, Thesis_scale$fi_score, Thesis_scale$LIE_score)

##24. BFS and BS thought listing and rating task
partial_BFSthoughlist <- Thesis_scale %>% 
  select(BFS_score, BSthought, LIE_score) %>% 
  drop_na()
pcor.test(partial_BFSthoughlist$BFS_score, partial_BFSthoughlist$BSthought, partial_BFSthoughlist$LIE_score)

##25. BFS and Wordsum Vocabulary Test
partial_BFSns <- Thesis_scale %>% 
  select(BFS_score, ns_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BFSns$BFS_score, partial_BFSns$ns_score, partial_BFSns$LIE_score)

##26. BFS and Numeracy scale
partial_BFSword <- Thesis_scale %>% 
  select(BFS_score, word_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BFSword$BFS_score, partial_BFSword$word_score, partial_BFSword$LIE_score)

##27. BFS and Cognitive Reflection Test
partial_BFScrt<- Thesis_scale %>% 
  select(BFS_score, crt_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BFScrt$BFS_score, partial_BFScrt$crt_score, partial_BFScrt$LIE_score)

```

### Bullshit Propensity scales and other variables's partial correlation when controled for lying tendency

```{r BPS and others}
##1. BPS and Thought listing and rating task
partial_BPSthoughlist <- Thesis_scale %>% 
  select(BPS_score, BSthought, LIE_score) %>% 
  drop_na()
pcor.test(partial_BPSthoughlist$BPS_score, partial_BPSthoughlist$BSthought, partial_BPSthoughlist$LIE_score)

##2. BPS and narcissism (short scale)
partial_BPSsdtnarc <- Thesis_scale %>% 
  select(BPS_score, sdtnarc_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BPSsdtnarc$BPS_score, partial_BPSsdtnarc$sdtnarc_score, partial_BPSsdtnarc$LIE_score)

##3, BPS and machiavellianism (short scale)
pcor.test(Thesis_scale$BPS_score, Thesis_scale$sdtmach_score, Thesis_scale$LIE_score)

##4. BPS and psychopathy (short scale)
pcor.test(Thesis_scale$BPS_score, Thesis_scale$sdtpsych_score, Thesis_scale$LIE_score)

##5. BPS and Narcissistic Personality Inventory
pcor.test(Thesis_scale$BPS_score, Thesis_scale$narc_score, Thesis_scale$LIE_score)

##6. BPS and Machiavellianism Personality scale
pcor.test(Thesis_scale$BPS_score, Thesis_scale$mach_score, Thesis_scale$LIE_score)

##7. BPS and Levenson Self-Report Psychopathy Scale
pcor.test(Thesis_scale$BPS_score, Thesis_scale$psycho_score, Thesis_scale$LIE_score)
##7.1
pcor.test(Thesis_scale$BPS_score, Thesis_scale$psychopri_score, Thesis_scale$LIE_score)
partial_BPSpsychosec <- Thesis_scale %>% 
  select(BPS_score, psychosec_score, LIE_score) %>% 
  drop_na()
##7.2
pcor.test(partial_BPSpsychosec$BPS_score, partial_BPSpsychosec$psychosec_score, partial_BPSpsychosec$LIE_score)

##8. BPS and self-esteem
pcor.test(Thesis_scale$BPS_score, Thesis_scale$se_score, Thesis_scale$LIE_score)

##BPS and HEXACO
##9. Honesty-Humility
partial_BPShon<- Thesis_scale %>% 
  select(BPS_score, hon_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BPShon$BPS_score, partial_BPShon$hon_score, partial_BPShon$LIE_score)
##10. Emotionality
partial_BPSemo <- Thesis_scale %>% 
  select(BPS_score, emo_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BPSemo$BPS_score, partial_BPSemo$emo_score, partial_BPSemo$LIE_score)
##11. Extraversion
partial_BPSextra <- Thesis_scale %>% 
  select(BPS_score, extra_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BPSextra$BPS_score, partial_BPSextra$extra_score, partial_BPSextra$LIE_score)
##12. Agreeableness
partial_BPSagree <- Thesis_scale %>% 
  select(BPS_score, agree_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BPSagree$BPS_score, partial_BPSagree$agree_score, partial_BPSagree$LIE_score)
##13. CONSCIENTIOUSNESS
partial_BPScons <- Thesis_scale %>% 
  select(BPS_score, cons_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BPScons$BPS_score, partial_BPScons$cons_score, partial_BPScons$LIE_score)
##14. Openness
partial_BPSopen <- Thesis_scale %>% 
  select(BPS_score, open_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BPSopen$BPS_score, partial_BPSopen$open_score, partial_BPSopen$LIE_score)

##15. BPS and Intellectual Humility Scale
partial_BPSih <- Thesis_scale %>% 
  select(BPS_score, ihs_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BPSih$BPS_score, partial_BPSih$ihs_score, partial_BPSih$LIE_score)

##16. BPS and Need for Closure
pcor.test(Thesis_scale$BPS_score, Thesis_scale$nclos_score, Thesis_scale$LIE_score)

##17. BPS and Need for Cognition
partial_BPSncog <- Thesis_scale %>% 
  select(BPS_score, ncog_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BPSncog$BPS_score, partial_BPSncog$ncog_score, partial_BPSncog$LIE_score)

##18. BPS and Actively Open Thinking Style
partial_BPSopenTS <- Thesis_scale %>% 
  select(BPS_score, openTS_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BPSopenTS$BPS_score, partial_BPSopenTS$openTS_score, partial_BPSopenTS$LIE_score)

##19. BPS and Close-minded Thinking Style
pcor.test(Thesis_scale$BPS_score, Thesis_scale$closeTS_score, Thesis_scale$LIE_score)

##20. BPS and prefer intuitive Thinking Style
partial_BPSintuitiveTS <- Thesis_scale %>% 
  select(BPS_score, intuitiveTS_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BPSintuitiveTS$BPS_score, partial_BPSintuitiveTS$intuitiveTS_score, partial_BPSintuitiveTS$LIE_score)

##21. BPS and prefer effortful Thinking Style
pcor.test(Thesis_scale$BPS_score, Thesis_scale$effortTS_score, Thesis_scale$LIE_score)

##22. BPS and Actively Open-Minded Thinking about Evidence Scale 
partial_BPSactiveopen <- Thesis_scale %>% 
  select(BPS_score, activeopen_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BPSactiveopen$BPS_score, partial_BPSactiveopen$activeopen_score, partial_BPSactiveopen$LIE_score)

##23. BPS and Faith in Intuition Scale
pcor.test(Thesis_scale$BPS_score, Thesis_scale$fi_score, Thesis_scale$LIE_score)

##24. BPS and Numeracy scale
partial_BPSns <- Thesis_scale %>% 
  select(BPS_score, ns_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BPSns$BPS_score, partial_BPSns$ns_score, partial_BPSns$LIE_score)

##25. BPS and Wordsum Vocabulary Test
partial_BPSword <- Thesis_scale %>% 
  select(BPS_score, word_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BPSword$BPS_score, partial_BPSword$word_score, partial_BPSword$LIE_score)

##26. BPS and Cognitive Reflection Test
partial_BPScrt<- Thesis_scale %>% 
  select(BPS_score, crt_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BPScrt$BPS_score, partial_BPScrt$crt_score, partial_BPScrt$LIE_score)
```
### Bullshit Thought Listing and Rating tasks and other variables's partial correlation when controled for lying tendency

```{r thought listing / rating and others}

##1. BSthought rating and listing and narcissism (short scale)
partial_BSthoughtsdtnarc <- Thesis_scale %>% 
  select(BSthought, sdtnarc_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughtsdtnarc$BSthought, partial_BSthoughtsdtnarc$sdtnarc_score, partial_BSthoughtsdtnarc$LIE_score)

##2, BSthought and machiavellianism (short scale)
partial_BSthoughtsdtmach <- Thesis_scale %>% 
  select(BSthought, sdtmach_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughtsdtmach$BSthought, partial_BSthoughtsdtmach$sdtmach_score, partial_BSthoughtsdtmach$LIE_score)

##3. BSthought and psychopathy (short scale)
partial_BSthoughtsdtpsych <- Thesis_scale %>% 
  select(BSthought, sdtpsych_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughtsdtpsych$BSthought, partial_BSthoughtsdtpsych$sdtpsych_score, partial_BSthoughtsdtpsych$LIE_score)

##4. BSthought and Narcissistic Personality Inventory
partial_BSthoughtnarc <- Thesis_scale %>% 
  select(BSthought, narc_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughtnarc$BSthought, partial_BSthoughtnarc$narc_score, partial_BSthoughtnarc$LIE_score)

##5. BSthought and Machiavellianism Personality scale
partial_BSthoughtmach <- Thesis_scale %>% 
  select(BSthought, mach_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughtmach$BSthought, partial_BSthoughtmach$mach_score, partial_BSthoughtmach$LIE_score)

##6. BSthought and Levenson Self-Report Psychopathy Scale
partial_BSthoughtpsych <- Thesis_scale %>% 
  select(BSthought, psycho_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughtpsych$BSthought, partial_BSthoughtpsych$psycho_score, partial_BSthoughtpsych$LIE_score)

##7. 
partial_BSthoughtpsychopri <- Thesis_scale %>% 
  select(BSthought, psychopri_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughtpsychopri$BSthought, partial_BSthoughtpsychopri$psychopri_score, partial_BSthoughtpsychopri$LIE_score)

##8.
partial_BSthoughtpsychosec <- Thesis_scale %>% 
  select(BSthought, psychosec_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughtpsychosec$BSthought, partial_BSthoughtpsychosec$psychosec_score, partial_BSthoughtpsychosec$LIE_score)

##9. BSthought and self-esteem
partial_BSthoughtse <- Thesis_scale %>% 
  select(BSthought, se_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughtse$BSthought, partial_BSthoughtse$se_score, partial_BSthoughtse$LIE_score)

##BSthought and HEXACO
##10. Honesty-Humility
partial_BSthoughthon<- Thesis_scale %>% 
  select(BSthought, hon_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughthon$BSthought, partial_BSthoughthon$hon_score, partial_BSthoughthon$LIE_score)
##11. Emotionality
partial_BSthoughtemo <- Thesis_scale %>% 
  select(BSthought, emo_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughtemo$BSthought, partial_BSthoughtemo$emo_score, partial_BSthoughtemo$LIE_score)
##12. Extraversion
partial_BSthoughtextra <- Thesis_scale %>% 
  select(BSthought, extra_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughtextra$BSthought, partial_BSthoughtextra$extra_score, partial_BSthoughtextra$LIE_score)
##13. Agreeableness
partial_BSthoughtagree <- Thesis_scale %>% 
  select(BSthought, agree_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughtagree$BSthought, partial_BSthoughtagree$agree_score, partial_BSthoughtagree$LIE_score)
##14. CONSCIENTIOUSNESS
partial_BSthoughtcons <- Thesis_scale %>% 
  select(BSthought, cons_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughtcons$BSthought, partial_BSthoughtcons$cons_score, partial_BSthoughtcons$LIE_score)
##15. Openness
partial_BSthoughtopen <- Thesis_scale %>% 
  select(BSthought, open_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughtopen$BSthought, partial_BSthoughtopen$open_score, partial_BSthoughtopen$LIE_score)

##16. BSthought and Intellectual Humility Scale
partial_BSthoughtih <- Thesis_scale %>% 
  select(BSthought, ihs_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughtih$BSthought, partial_BSthoughtih$ihs_score, partial_BSthoughtih$LIE_score)

##17. BSthought and Need for Closure
partial_BSthoughtnclos <- Thesis_scale %>% 
  select(BSthought, nclos_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughtnclos$BSthought, partial_BSthoughtnclos$nclos_score, partial_BSthoughtnclos$LIE_score)

##18. BSthought and Need for Cognition
partial_BSthoughtncog <- Thesis_scale %>% 
  select(BSthought, ncog_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughtncog$BSthought, partial_BSthoughtncog$ncog_score, partial_BSthoughtncog$LIE_score)

##19. BSthought and Actively Open Thinking Style
partial_BSthoughtopenTS <- Thesis_scale %>% 
  select(BSthought, openTS_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughtopenTS$BSthought, partial_BSthoughtopenTS$openTS_score, partial_BSthoughtopenTS$LIE_score)

##20. BSthought and Close-minded Thinking Style
partial_BSthoughtcloseTS <- Thesis_scale %>% 
  select(BSthought, closeTS_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughtcloseTS$BSthought, partial_BSthoughtcloseTS$closeTS_score, partial_BSthoughtcloseTS$LIE_score)

##21. BSthought and prefer intuitive Thinking Style
partial_BSthoughtintuitiveTS <- Thesis_scale %>% 
  select(BSthought, intuitiveTS_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughtintuitiveTS$BSthought, partial_BSthoughtintuitiveTS$intuitiveTS_score, partial_BSthoughtintuitiveTS$LIE_score)

##22. BSthought and prefer effortful Thinking Style
partial_BSthoughteffortTS <- Thesis_scale %>% 
  select(BSthought, effortTS_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughteffortTS$BSthought, partial_BSthoughteffortTS$effortTS_score, partial_BSthoughteffortTS$LIE_score)

##23. BSthought and Actively Open-Minded Thinking about Evidence Scale 
partial_BSthoughtactiveopen <- Thesis_scale %>% 
  select(BSthought, activeopen_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughtactiveopen$BSthought, partial_BSthoughtactiveopen$activeopen_score, partial_BSthoughtactiveopen$LIE_score)

##24. BSthought and Faith in Intuition Scale
partial_BSthoughtfi <- Thesis_scale %>% 
  select(BSthought, fi_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughtfi$BSthought, partial_BSthoughtfi$fi_score, partial_BSthoughtfi$LIE_score)

##25. BSthought and Wordsum Vocabulary Test
partial_BSthoughtns <- Thesis_scale %>% 
  select(BSthought, ns_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughtns$BSthought, partial_BSthoughtns$ns_score, partial_BSthoughtns$LIE_score)

##26. BSthought and Numeracy scale
partial_BSthoughtword <- Thesis_scale %>% 
  select(BSthought, word_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughtword$BSthought, partial_BSthoughtword$word_score, partial_BSthoughtword$LIE_score)

##27. BSthought and Cognitive Reflection Test
partial_BSthoughtcrt<- Thesis_scale %>% 
  select(BSthought, crt_score, LIE_score) %>% 
  drop_na()
pcor.test(partial_BSthoughtcrt$BSthought, partial_BSthoughtcrt$crt_score, partial_BSthoughtcrt$LIE_score)
```
## Step 2: pearson correlation
### BSF and others
```{r pearson correlation BSF}
cor(Thesis_scale$BFS_score, Thesis_scale$BPS_score, use = "complete.obs")
cor(Thesis_scale$BFS_score, Thesis_scale$BSthought, use = "complete.obs")
cor(Thesis_scale$BPS_score, Thesis_scale$BSthought, use = "complete.obs")
cor.test(Thesis_scale$BPS_score, Thesis_scale$BSthought, method=c("pearson"))
colnames(Thesis_scale) 
##1. BFS and BPS
cor.test(Thesis_scale$BPS_score, Thesis_scale$BFS_score, method=c("pearson"))

# create the dataframe with 4 columns 
bs_variables <- c("BFS_score", "BFSe_score", "BFSp_score", "BPS_score", "LIE_score", "sdtnarc_score", "sdtmach_score", "sdtpsych_score", "narc_score", "mach_score", "psycho_score", "psychopri_score", "psychosec_score", "se_score", "hon_score", "emo_score", "extra_score", "agree_score", "cons_score", "open_score", "ihs_score", "nclos_score", "ncog_score", "openTS_score", "closeTS_score", "intuitiveTS_score", "effortTS_score", "activeopen_score", "fi_score", "crt_score", "word_score", "ns_score", "BSthought" )

correlates_bs <- Thesis_scale[, bs_variables]
correlates <- round(cor(correlates_bs, use = "pairwise.complete.obs"), 2)
corr_results <- corr.test(correlates_bs, use = "pairwise", method = "pearson")
corr_results$r      
corr_results$p

```

### heat map for correlations

```{r heatmap1, fig.width=12, fig.height=8}
## I have found how to do heat map for correlation matrix here: https://www.geeksforgeeks.org/how-to-create-correlation-heatmap-in-r/
## I want to make a heat map because I have almost 30 variables and I think this can be a good way for visualization

#First, I will need to create a correlation matrix
corr_mat <- round(cor(correlates_bs, use = "pairwise.complete.obs"), 2)

#Next, in order for better too look at, I will reorder the matrix by using corr coefficient as distance metric
dist <- as.dist((1-corr_mat)/2)
 
#Then, hierarchically clustering the dist matrix
hc <- hclust(dist)
corr_mat <-corr_mat[hc$order, hc$order]
 
#Also reduce the size of correlation matrix
melted_corr_mat <- melt(corr_mat)

#Lastly, I can plot the correlation heatmap
ggplot(data = melted_corr_mat, aes(x=Var1, y=Var2, fill=value)) + 
  geom_tile() +
  scale_fill_gradient2(low = "#ffa700", mid = "white", high = "#b53389", midpoint = 0) +
  theme_minimal() 
```

```{r heatmap2, fig.width=12, fig.height=8}
## Although the previous heat map is a good visualization, it does not provide any information for the excat number for each correlation value and the correlation between A and B is the same as between B and A, which makes the map redundant. Therefore, I find a more interactive heat map in the link that allows me to check for each variable and only show each correlation once. 
colnames(correlates_bs) <- gsub("_score", "", colnames(correlates_bs))
p_mat <- cor_pmat(correlates_bs)
##plotting the interactive corr heatmap
corr_mat <- ggcorrplot(
  corr_mat, hc.order = TRUE, type = "lower",
  outline.col = "white",
  p.mat = p_mat,
  insig = "blank", ##I added this code just to hide the insignificant ones, so it will not look messy
  colors = c("#281e5d", "white", "#ff4f00")
)
corr_mat <- corr_mat + theme(
  axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 8),
  axis.text.y = element_text(size = 8)
)
corr_mat <- corr_mat + theme_minimal(base_size = 10)
ggplotly(corr_mat)

```

This looks pretty good! If you put your mouse on one of the color block (the correlation value), you will be able to see what two variables are correlated and what is the correlation value. It is really easy to see which has high correlation as well!
